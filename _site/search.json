[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Econometric and Geospatial Analysis",
    "section": "",
    "text": "” This is my favorite quote of the day “\n —By me \n\n\n\n\n\n\n\n   \n     \n     \n       Order By\n       Default\n         \n          Date - Oldest\n        \n         \n          Date - Newest\n        \n     \n  \n    \n      \n      \n    \n\n\n\n\n\n\n\n\n\n\nTheme Configuration\n\n\n\nquarto\n\n\ndesign\n\n\n\nA hotchpotch of Boostrap 5 theme customizations for this Quarto blog.\n\n\n\nMelanie BACOU\n\n\nDec 1, 2022\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nMerge Ground and Satellite Observations with RFMerge\n\n\n\nmeteo\n\n\nrisk modeling\n\n\n\nRecalibrate ERA5 hourly temperatures to CIMIS network ground observations.\n\n\n\nMelanie BACOU\n\n\nJan 16, 2021\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nERA5-LAND Temperature Validation (California)\n\n\n\nrisk modeling\n\n\n\nCan we justify winter Y2017 corrections to ERA5-LAND temperature grids over central California?\n\n\n\nMelanie BACOU\n\n\nDec 2, 2020\n\n\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "portfolio.html",
    "href": "portfolio.html",
    "title": "Design Portfolio",
    "section": "",
    "text": "An annotated collection of visuals and tools I have built in the past for research teams, partners and clients.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nInteractive Web Applications\n\n\nMy Design Portfolio\n\n\n\ndesign\n\n\nR/Shiny\n\n\n\nShowcase of interactive statistical dashboards and decision-support tools designed for partners and clients. \n\n\n\n\n\nFeb 1, 2024\n\n\nMelanie BACOU\n\n\n\n\n\n\n\n\n\n\n\n\nTableau® Dashboards\n\n\nMy Design Portfolio\n\n\n\ndesign\n\n\ntableau\n\n\n\nShowcase of interactive statistical dashboards and decision-support tools designed for partners and clients. \n\n\n\n\n\nJan 30, 2024\n\n\nMelanie BACOU\n\n\n\n\n\n\n\n\n\n\n\n\nPrint Design\n\n\nMy Design Portfolio\n\n\n\ndesign\n\n\n\nShowcase of print posters, bulletins and handouts designed for partners and clients. \n\n\n\n\n\nJan 30, 2024\n\n\nMelanie BACOU\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "BACOU, Melanie",
    "section": "",
    "text": "t.me/mbacou\n    linkedin.com/in/mbacou\n    github.com/mbacou\n    orcid.org/0000-0003-1810-6818\n\n\nCost/benefit analysis\nEconomic impact evaluation\nSpatial econometrics\nAgrometeorology\nWeather risk and adaptation\nParametric risk transfer\nR, STATA, QGIS\n\n\n\nFrench (native)\nEnglish (bilingual)\nGerman (limited working)\nRussian (beginner)\n\n\n\nSAS® Programming III"
  },
  {
    "objectID": "about.html#education",
    "href": "about.html#education",
    "title": "Melanie Bacou",
    "section": "",
    "text": "University of California, San Diego | San Diego, CA PhD in Mathematics | Sep 2011 - June 2015\nMacalester College | St. Paul MA B.A in Economics | Sep 2007 - June 2011"
  },
  {
    "objectID": "about.html#experience",
    "href": "about.html#experience",
    "title": "Melanie Bacou",
    "section": "",
    "text": "Wengo Analytics | Head Data Scientist | April 2018 - present\nGeoScynce | Chief Analyst | Spet 2012 - April 2018"
  },
  {
    "objectID": "license.html",
    "href": "license.html",
    "title": "Open Source License",
    "section": "",
    "text": "Quarto version 1.3 (and earlier) is licensed under the GNU GPL v2. Quarto version 1.4 is licensed under the MIT License. We believe that it’s better for everyone if the tools used for research and science are free and open. Reproducibility, widespread sharing of knowledge and techniques, and the leveling of the playing field by eliminating cost barriers are but a few of the shared benefits of free software in science.\nThe Quarto source code is available at https://github.com/quarto-dev/\nQuarto also makes use of several other open-source projects, the distribution of which is subject to their respective licenses. Major components and their licenses include:\n\n\n\nProject\nLicense\n\n\n\n\nPandoc\nGNU GPL v2\n\n\nBootstrap 5.1\nMIT\n\n\nBootswatch 5.1\nMIT\n\n\nDeno\nMIT\n\n\nesbuild\nMIT\n\n\nDart Sass\nMIT\n\n\nObservable Runtime\nISC"
  },
  {
    "objectID": "posts/2022-12-01-armyvet/index.html",
    "href": "posts/2022-12-01-armyvet/index.html",
    "title": "Theme Configuration",
    "section": "",
    "text": "Optional flushed banner with random static or dynamic content. Note that this will push the TOC to the top of the page until the user scrolls past the DIV."
  },
  {
    "objectID": "posts/2021-01-16-rfmerge/index.html",
    "href": "posts/2021-01-16-rfmerge/index.html",
    "title": "Merge Ground and Satellite Observations with RFMerge",
    "section": "",
    "text": "We want to recalibrate ERA5-LAND hourly temperatures to CIMIS ground network observations to address ERA5-LAND model biases noted in California:\n\nBuild CIMIS time-series across OLAM portfolio extent\n\nBuild DEM covariate using ERA5-LAND extent and spatial resolution\n\nUse RFMerge procedure1 to produce calibrated hourly raster stacks over the past 10 years (limit calibration from Jan-01 to Apr-30 every year)\n\n1 See Baez-Villanueva, O. M., Zambrano-Bigiarini, M., Diego, J., Osorio, G.-, & Mcnamara, I. (2020). Tutorial for merging satellite-based precipitation datasets with ground observations using RFmerge.This work was initially performed for WorldCover PBC and OLAM US, redacted here to omit confidential details.\n\n\nlibrary(rmarkdown)\nlibrary(lattice)\nlibrary(raster)\n## Loading required package: sp\nlibrary(tmap)\nlibrary(scales)\nlibrary(data.table)\n## \n## Attaching package: 'data.table'\n## The following object is masked from 'package:raster':\n## \n##     shift\nlibrary(zoo)\n## \n## Attaching package: 'zoo'\n## The following objects are masked from 'package:base':\n## \n##     as.Date, as.Date.numeric\nlibrary(cimir)\n## Using existing App Key from \"CIMIS_APPKEY\" environment variable.\nlibrary(sf)\n## Linking to GEOS 3.10.2, GDAL 3.4.3, PROJ 8.2.0; sf_use_s2() is TRUE\n## WARNING: different compile-time and runtime versions for GEOS found:\n## Linked against: 3.10.2-CAPI-1.16.0 compiled against: 3.10.1-CAPI-1.16.0\n## It is probably a good idea to reinstall sf, and maybe rgeos and rgdal too\nlibrary(RFmerge)\n## (C) 2019 M. Zambrano-Bigiarini and Oscar M. Baez-Villanueva (GPL &gt;=3 license)\n## Type 'citation('RFmerge')' to see how to cite this package\n\ndir &lt;- \".\"\nload(file.path(dir, \"./tmp/2020-burn_olam_usa_06.RData\"))\n\n# Default color palette\npal &lt;- readRDS(\"../../_assets/pal_iwmi.rds\")\n\nmy.settings &lt;- list(\n  superpose.polygon=list(col=alpha(pal, .6), border=\"transparent\"),\n  strip.background=list(col=pal[\"light\"])\n)\n#trellis.par.set(my.settings) \n\nDefine zone of interest and load covariate layers.\n\n# Clear workspace, keep portfolio details\nload(file.path(dir, \"./tmp/2020-burn_olam_usa_04.RData\"))\nrm(list=setdiff(ls(), c(\"dir\", \"pts.dt\")))\n\npts &lt;- SpatialPointsDataFrame(pts.dt[, .(X,Y)], data.frame(pts.dt), \n  proj4string=CRS(\"+init=epsg:4326\"))\n\nusa &lt;- getData(\"GADM\", country=\"USA\", level=2)\n# Limit to OLAM counties\nusa &lt;- usa[usa$NAME_2 %in% pts.dt[, unique(adm2_nm)],]\nzoi &lt;- extent(usa)\nzoi\n# class      : Extent \n# xmin       : -121.4844 \n# xmax       : -117.6166 \n# ymin       : 34.7902 \n# ymax       : 38.07786 \n\n# Catalog hourly ERA5 tmean\nf &lt;- list.files(file.path(dir, \"../maps/ERA5LAND/2m_temperature/hourly/usa.ca\"), \".nc\", \n  recursive=T, full.names=T)\n\n# Verify data archive\nn &lt;- sapply(f, function(x) nlayers(brick(x, quick=T)))\nunique(n)\n# [1] 23 24  1 22\nbad &lt;- f[names(n[n&lt;24])]\nn &lt;- sapply(f[bad], function(x) nlayers(brick(x, quick=T)))\ndata.table(\n  fname = basename(f[bad]),\n  nlayers = n)\n#                  fname nlayers\n# 1: daily_1981-01-01.nc      23\n# 2: daily_2020-08-01.nc       1\n# 3: daily_2020-10-01.nc      22\n# 4: daily_2020-10-02.nc      22\n# 5: daily_2020-10-03.nc      22\n# 6: daily_2020-10-15.nc      22\n\nN &lt;- lapply(f[1:10], function(x) {\n  s = brick(x, quick=T)\n  s = setMinMax(s)\n  s = minValue(s) == maxValue(s)\n  which(s)\n})\nbad &lt;- N[sapply(N, `!=`, integer(0))]\n\nObtain long-term weather station records from CIMIS API.\n\nset_key(\"27ab5faa-abbb-475e-8af1-f380862bca61\")\nitem &lt;- \"hly-air-tmp\"\n\n# Keep all CIMIS stations inside ZOI\nobs.gis &lt;- cimis_station()\nsetDT(obs.gis)\nobs.gis[1:3, .(ConnectDate, DisconnectDate, HmsLatitude, HmsLongitude)]\n#    ConnectDate DisconnectDate           HmsLatitude              HmsLongitude\n# 1:    6/7/1982      9/25/1988 36º48'52N / 36.814444 -119º43'54W / -119.731670\n# 2:    6/7/1982      9/25/1988 36º48'52N / 36.814444 -119º43'54W / -119.731670\n# 3:    6/7/1982      9/25/1988 36º48'52N / 36.814444 -119º43'54W / -119.731670\n\nobs.gis[, `:=`(\n  # HMS Lat/Lon to degree\n  X = unlist(tstrsplit(HmsLongitude, \" / \", fixed=T, keep=2L)),\n  Y = unlist(tstrsplit(HmsLatitude, \" / \", fixed=T, keep=2L))\n)][, `:=`(\n  X = as.numeric(X),\n  Y = as.numeric(Y)\n)][, `:=`(\n  # Cast dates\n  date_start = as.Date(ConnectDate, format=\"%m/%d/%Y\"),\n  date_end = as.Date(DisconnectDate, format=\"%m/%d/%Y\")\n)]\n\nobs.gis[1:3, .(HmsLongitude, HmsLatitude, X, Y, date_start, date_end)]\nobs.gis &lt;- obs.gis[, .(StationNbr, Name, X, Y, date_start, date_end, IsActive)]\n\n# There are duplicated stations (?)\nobs.gis &lt;- unique(obs.gis, by=c(\"StationNbr\", \"X\", \"Y\", \"date_start\"))\nanyDuplicated(obs.gis, by=\"StationNbr\")\n\n# Date ranges that are available\nobs.gis[, .(range(date_start), range(date_end))]\n#            V1         V2\n# 1: 1982-05-30 1985-07-23\n# 2: 2020-10-28 2050-12-31\n\nobs.gis &lt;- SpatialPointsDataFrame(obs.gis[, .(X, Y)], data.frame(obs.gis),\n  proj4string=CRS(\"+init=epsg:4326\"))\nobs.gis &lt;- crop(obs.gis, zoi)\n\n# Plot maps\nplot(crop(raster(r, layer=2), zoi), main=basename(f[2]))\nplot(pts, add=T, pch=\"*\")\nplot(obs.gis, add=T, col=c(\"red\", \"green\")[1+(obs.gis$IsActive==\"True\")], pch=\"x\")\n\nobs.lst &lt;- obs.gis@data[, \"StationNbr\"]\nlength(obs.lst)\n\nobs.gis &lt;- setDT(obs.gis@data)\n\n# API limit at 1,750 records so batch it\ndrange &lt;- c(\"2017-01-01\", \"2017-04-30\")\nobs &lt;- lapply(obs.lst, function(x) {\n  date_start = obs.gis[StationNbr==x, date_start]\n  date_end = obs.gis[StationNbr==x, date_end]\n  date_start = pmax(as.Date(drange[1]), date_start)\n  date_end = pmin(as.Date(drange[2]), date_end)\n  res = if(date_end &gt;= date_start) {\n    s = seq.Date(date_start, date_end, by=\"10 days\")\n    lapply(s, function(y) {\n      t = try(cimis_data(\n        targets=as.integer(x), items=item, measure.unit=\"M\", start.date=y, end.date=y+10-1))\n      t = if(class(t)[1]==\"try-error\") NULL else setDT(t)\n      return(t)\n    })\n  } else NULL\n  return(res)\n})\n\nobs &lt;- lapply(obs, rbindlist)\nnames(obs) &lt;- obs.lst\nobs &lt;- rbindlist(obs, fill=T, idcol=\"StationNbr\")\n\n# Clean up\nobs[, `:=`(\n  Name = NULL,\n  Type = NULL,\n  Owner = NULL,\n  Standard = NULL,\n  ZipCodes = NULL,\n  Item = NULL,\n  Qc = NULL,\n  Unit = NULL\n)]\n\n# Verify\nobs[StationNbr != Station, .N]\nobs[, .N, by=Scope]\nobs[, `:=`(\n  Station = NULL,\n  Scope = NULL\n)]\n\n# Tally\nobs[, .(.N, min(Date), max(Date)), keyby=.(StationNbr)]\n# =&gt; \"232\" station missing records 2160/2880\nobs[, .(.N, sum(is.na(Value)), min(Date), max(Date)), keyby=.(StationNbr)]\n24*(as.Date(drange[2])-as.Date(drange[1])+1)\n\n# Nearest to OLAM3 portfolio\nids &lt;- c(168, 206, 145, 188, 148)\nfwrite(obs[StationNbr %in% as.character(ids)], \"./out/CIMIA_OLAM3_2017.csv\")\n\nPrepare DEM at ERA5 layers.\n\n# Prepare DEM at ERA5 extent and resolution\ndem1 &lt;- getData(\"SRTM\", lon=zoi[2], lat=zoi[3])\ndem2 &lt;- getData(\"SRTM\", lon=zoi[1], lat=zoi[4])\ndem3 &lt;- getData(\"SRTM\", lon=zoi[2], lat=zoi[4])\ndem4 &lt;- getData(\"SRTM\", lon=zoi[1], lat=zoi[3])\ndem &lt;- merge(dem1, dem2, dem3, dem4, ext=zoi)\n\nFormat station time-series to Zoo wide arrays.\n\n# Prep station time-series, require ZOO wide format\nobs[, Time := paste(as.character(Date), Hour)\n][, c(\"Date\", \"Time\") := IDateTime(\n  as.POSIXlt(Time, format=\"%Y-%m-%d %H%M\", tz=\"America/Los_Angeles\"))]\nView(obs[c(1:30, .N)])\n# 2017-01-01 2300 =&gt; 2017-01-01 23:00\n# 2017-01-01 2400 =&gt; 2017-01-02 00:00\n# =&gt; OK\nsetorder(obs, StationNbr, Date, Time)\nobs.ts &lt;- dcast(obs, Date+Time~StationNbr, value.var=\"Value\")\nobs.ts &lt;- zoo(\n  obs.ts[, .SD, .SDcols=-c(1:2)], \n  order.by=obs.ts[, as.POSIXlt(paste(Date, Time, tz=\"America/Los_Angeles\"))]\n)\n\nImplement Random Forest merge algorithm.\n\n# Cut the series at Jan-Apr 2017 (time constraint)\ndrange &lt;- c(\"2017-01-01\", \"2017-04-30\")\nx1 &lt;- which(f %like% drange[1])\nx2 &lt;- which(f %like% drange[2])\nf &lt;- f[x1:x2]\nf[1]\n\n# Limit ERA5 covariate\nera &lt;- brick(as.list(f))\nera &lt;- crop(era, zoi, filename=\"./out/ERA5_2m_temperature_2017.grd\", overwrite=T)\nera &lt;- brick(\"./out/ERA5_2m_temperature_2017.grd\")\n\n# Align DEM to ERA5\ndem &lt;- resample(dem, era[[1]], filename=\"./out/SRTM_ERA5.grd\")\nidentical(res(dem), res(era))\nidentical(extent(dem), extent(era))\nidentical(nlayers(era), nrow(obs.ts))\n\n# ZOI require SF\nstations &lt;- sf::st_as_sf(obs.gis, coords=c(\"X\", \"Y\"), crs=4326)\nzoi &lt;- st_as_sfc(st_bbox(usa))\nzoi &lt;- st_sf(data.frame(ID=1), geom=zoi)\n\n# Verify CRS\nidentical(st_crs(zoi), st_crs(era))\nidentical(st_crs(r), st_crs(era))\n\n# Reproject all to NAD_1983_California_Teale_Albers\nNAD83 &lt;- CRS(\"+init=epsg:3310\")\nera &lt;- projectRaster(from=era, crs=NAD83)\ndem &lt;- projectRaster(from=dem, crs=NAD83)\nstations &lt;- st_transform(stations, crs=3310)\npts &lt;- spTransform(pts, CRS(\"+init=epsg:3310\"))\nzoi &lt;- st_transform(zoi, crs=3310)\nobs.gis[, `:=`(\n  Lon = st_coordinates(stations)[, \"X\"],\n  Lat = st_coordinates(stations)[, \"Y\"]\n)]\n\n# Covariates\ncovariates &lt;- list(era=era, dem=dem)\nobs.meta &lt;- obs.gis[StationNbr %in% names(obs.ts), .(StationNbr, Lon, Lat)]\n\n# RFmerge\ndir.create(\"./out/2017_RFmerge_proj\")\nmc.cores &lt;- parallel::detectCores()-2\n\nrfmep &lt;- RFmerge(\n  x = obs.ts, \n  metadata = obs.meta, \n  cov = covariates, \n  id=\"StationNbr\", lat=\"Lat\", lon=\"Lon\", ED=TRUE,\n  mask=zoi, training=0.9, write2disk=TRUE, drty.out=\"./out/2017_RFmerge_proj\",\n  parallel=\"parallel\", par.nnodes=mc.cores)\n\nnames(rfmep)[c(1:2, nlayers(rfmep))]\n# [1] \"X2017.01.01.01.00.00\" \"X2017.01.01.02.00.00\" \"X2017.05.01.00.00.00\"\n\ncrs(rfmep)\n\nExtract recalibrated time-series across almond production sites.\n\n# Extract recalibrated time-series across production sites\nremoveTmpFiles(h=0)\ndt.imp &lt;- extract(rfmep, pts)\ndt.imp = as.data.table(dt.imp, keep.rownames=TRUE)\ndt.imp[, loc_id := pts$loc_id]\ndt.imp = melt(dt.imp, id.vars=\"loc_id\", variable.name=\"time\", value.name=\"value\", variable.factor=F)\ndt.imp[, time := as.POSIXct(time, format=\"X%Y.%m.%d.%H.%M.%OS\", tz=\"America/Los_Angeles\")]\n\ndt.imp[, range(time)]\ndt.imp[, `:=`(\n  # Convert to IDate\n  date = as.IDate(time),\n  time = as.ITime(time)\n)]\n\n# Re-extract ERA5-LAND over period to double-check\nr &lt;- brick(f[1], quick=T)\npts &lt;- spTransform(pts, crs(r))\ndt.era &lt;- lapply(f, function(x) {\n  r = brick(x, quick=T)\n  y = extract(r, pts)\n  y = as.data.table(y, keep.rownames=TRUE)\n  y[, loc_id := pts$loc_id]\n  y = melt(y, id.vars=\"loc_id\", variable.name=\"time\", value.name=\"value\", variable.factor=F)\n  y[, time := as.POSIXct(time, format=\"X%Y.%m.%d.%H.%M.%OS\", tz=\"UTC\")]\n})\ndt.era &lt;- rbindlist(dt.era)\ndt.era[, range(time)]\ndt.era[, `:=`(\n  # Convert to IDate\n  date = as.IDate(time),\n  time = as.ITime(time)\n)]\n\n# Impute ERA5 hourly time-series with output of RFmerge\ndt &lt;- readRDS(file.path(dir, \"./tmp/2020-tmean-hourly_olam_ca_almd.rds\"))\ndt.imp[dt, on=.(loc_id, date, time), era := i.value\n][dt.era, on=.(loc_id, date, time), era_valid := i.value]\n\n# Save\ndt &lt;- dt[!dt.imp, on=.(loc_id, date, time)]\ndt &lt;- rbind(dt, dt.imp[, .SD, .SDcols=names(dt)])\nsetorder(dt, loc_id, date, time)\nsaveRDS(dt, file.path(dir, \"./tmp/2020-tmean-hourly_olam_ca_almd_imputed.rds\"))\n\n\nrm(x, i, j, t, tmp, dem1, dem2, dem3, dem4, n, x1, x2, dt, dtc)\nsave.image(file.path(dir, \"./tmp/2020-burn_olam_usa_06.RData\"))\n\nValidate ZOI, DEM, and ERA5 covariates.\n\nera &lt;- brick(\"./out/ERA5_2m_temperature_2017.grd\")\nera &lt;- raster(era, 1)\n\ntmap_mode(\"view\")\n## tmap mode set to interactive viewing\ntm_shape(era) + \n  tm_raster(title=\"ERA5-LAND&lt;br/&gt;Temperature&lt;br/&gt;2020-02-01 00:00&lt;br/&gt;°C\", alpha=.6) +\n  tm_shape(stations) + tm_dots(\"black\", title=\"CIMIS WS\") + \n  tm_shape(pts) + tm_dots(\"blue\", title=\"OLAM Site\") + \n  tm_shape(pts[pts$loc_id %in% c(25, 82, 83), ]) + \n  tm_dots(\"red\")\n## Variable(s) \"NA\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\nDEM at ERA5 extent and resolution.\n\npts &lt;- spTransform(pts, CRS(\"+init=epsg:3310\"))\n\nplot(dem, main=\"SRTM 90m (meter)\",\n  col=terrain.colors(80, alpha=1))\nplot(zoi, add=T, lty=2, col=NA)\nplot(pts, add=T, pch=16)\nplot(stations, add=T, col=pal[c(\"red\", \"green\")][1+(obs.gis$IsActive==\"True\")], pch=\"x\")\n## Warning in plot.sf(stations, add = T, col = pal[c(\"red\", \"green\")][1 +\n## (obs.gis$IsActive == : ignoring all but the first attribute\nlegend(\"topright\", legend=c(\"Active station\", \"Stale station\", \"Production site\"),\n  col=pal[c(\"red\", \"green\", \"black\")], pch=c(\"x\", \"x\", \"o\"), cex=.8)\n\n\n\n\n\n\n\n\nCIMIS station observations between Jan-Apr 2017.\n\nobs[, .(\n  `Obs.` = comma(.N), \n  `NA` = percent(sum(is.na(Value))/.N), \n  `Min.` = min(Value, na.rm=T), \n  `Max.` = max(Value, na.rm=T),\n  `Date Range` = paste(range(Date, na.rm=T), collapse=\" - \")\n), keyby=.(StationNbr)] %&gt;%\n  paged_table()\n\n\n\n\nCIMIS Station Observations, Jan-Apr 2017\n\n\n\n\nplot(obs.ts[,1], col=alpha(pal[1], .7),\n  main=paste(\"Station\", names(obs.ts)[1]), xlab=\"Hourly Temp. °C\", ylab=NA)\ngrid()\n\n\n\n\n\n\n\n\nplot(obs.ts[,20], col=alpha(pal[1], .7),\n  main=paste(\"Station\", names(obs.ts)[20]), xlab=\"Hourly Temp. °C\", ylab=NA)\ngrid()\n\n\n\n\n\n\n\n\n\nhistogram(~Value|StationNbr, data=obs, \n  col=alpha(pal[1], .6), border=pal[\"black\"],\n  par.settings=my.settings,\n  layout=c(2,6), xlab=\"Jan-Apr 2017 Hourly Temp. °C\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nplot(rfmep[[1]], main=\"RF-MEP Temperatures\", xlab=names(rfmep)[1],\n  col=terrain.colors(80, alpha=1))\nplot(pts, pch=16, col=pal[\"black\"], add=T)\nplot(stations[stations$StationNbr %in% names(obs.ts),], pch=\"x\", col=pal[\"black\"], add=T)\n## Warning in plot.sf(stations[stations$StationNbr %in% names(obs.ts), ], pch = \"x\", :\n## ignoring all but the first attribute\nlegend(\"topright\", legend=c(\"Active station\", \"Production site\"), pch=c(\"x\", \"o\"), cex=.8)\n\n\n\n\n\n\n\n\n\nplot(era[[1]], main=\"ERA5-LAND Temperatures\", xlab=names(era)[1],\n  col=terrain.colors(80, alpha=1))\nplot(pts, pch=16, col=pal[\"black\"], add=T)\nplot(stations[stations$StationNbr %in% names(obs.ts),], pch=\"x\", col=pal[\"black\"], add=T)\n## Warning in plot.sf(stations[stations$StationNbr %in% names(obs.ts), ], pch = \"x\", :\n## ignoring all but the first attribute\nlegend(\"topright\", legend=c(\"Active station\", \"Production site\"), pch=c(\"x\", \"o\"), cex=.8)\n\n\n\n\n\n\n\n\nHourly time-series from CIMIS ground stations:\n\n\nwireframe(Value~as.numeric(Date)*Time, data=obs, \n  xlab=\"Date\", ylab=\"Hour\", sub=\"CIMIS Stations - Hourly Temp. °C\",\n  col=NA, col.regions=terrain.colors(100, alpha=.4), drape=T,\n  at=do.breaks(c(-5,35), 100)\n)\n\n\n\n\n\n\n\n\nCompared to hourly time-series at production sites from ERA5-LAND:\n\n\nwireframe(era~as.numeric(date)*time, data=dt.imp, \n  xlab=\"Date\", ylab=\"Hour\", zlab=\"°C\",  \n  sub=\"Production Sites - Hourly Temp. °C (ERA5-LAND)\",\n  col=NA, col.regions=terrain.colors(100, alpha=.4), drape=T,\n  at=do.breaks(c(-5,30), 100)\n)\n\n\n\n\n\n\n\n\nMean recalibration effect across production sites (after RFmerge):\n\n\nwireframe((value-era)~as.numeric(date)*time, data=dt.imp, \n  xlab=\"Date\", ylab=\"Hour\", zlab=\"°C\",  \n  sub=\"ERA5-LAND Mean Recalibration Effect\\nacross Production Sites\\nHourly Temp. °C\",\n  col=NA, col.regions=terrain.colors(100, alpha=.4), drape=T\n)\n\n\n\n\n\n\n\n\nFDD index across sites between Feb-01 and Mar-31, 2017 (before and after ground calibration):\n\ndt.imp[date %between% c(\"2017-02-01\", \"2017-03-31\"), .(\n  era = min(era, na.rm=T),\n  era_valid = min(era_valid, na.rm=T),\n  value = min(value, na.rm=T)\n), by=.(loc_id, date)][, .(\n  `FDD (before)` = sum(fifelse(era&lt;0, pmax(era, -4, na.rm=T), 0), na.rm=T),\n  `FDD (validate)` = sum(fifelse(era_valid&lt;0, pmax(era_valid, -4, na.rm=T), 0), na.rm=T),\n  `FDD (after)` = sum(fifelse(value&lt;0, pmax(value, -4, na.rm=T), 0), na.rm=T)\n), keyby=.(loc_id)]%&gt;%\n  paged_table()\n\n\n\n\nFDD across sites between Feb-01 and Mar-31, 2017\n\n\n\n\n\n\nCitationBibTeX citation:@online{bacou2021,\n  author = {BACOU, Melanie},\n  title = {Merge {Ground} and {Satellite} {Observations} with {RFMerge}},\n  date = {2021-01-16},\n  url = {https://mbacou.com/posts/2021-01-16-rfmerge},\n  langid = {en}\n}\nFor attribution, please cite this work as:\nBACOU, Melanie. 2021. “Merge Ground and Satellite Observations\nwith RFMerge.” January 16, 2021. https://mbacou.com/posts/2021-01-16-rfmerge."
  },
  {
    "objectID": "about.html#contact-info",
    "href": "about.html#contact-info",
    "title": "Melanie Bacou",
    "section": "",
    "text": "mel@mbacou.com\n +1 (202) 492-7978\n +33 6 95 73 73 97\n +7 953 1630593\n t.me/mbacou\n linkedin.com/in/mbacou\n github.com/mbacou\n orcid.org/0000-0003-1810-6818"
  },
  {
    "objectID": "about.html#top-skills",
    "href": "about.html#top-skills",
    "title": "BACOU, Melanie",
    "section": "",
    "text": "Cost/benefit analysis\nEconomic impact evaluation\nSpatial econometrics\nAgrometeorology\nWeather risk and adaptation\nParametric risk transfer\nR, STATA, QGIS"
  },
  {
    "objectID": "about.html#languages",
    "href": "about.html#languages",
    "title": "BACOU, Melanie",
    "section": "",
    "text": "French (native)\nEnglish (bilingual)\nGerman (limited working)\nRussian (beginner)"
  },
  {
    "objectID": "about.html#certifications",
    "href": "about.html#certifications",
    "title": "BACOU, Melanie",
    "section": "",
    "text": "SAS® Programming III"
  },
  {
    "objectID": "about.html#international-water-management-institute-iwmi",
    "href": "about.html#international-water-management-institute-iwmi",
    "title": "BACOU, Melanie",
    "section": "International Water Management Institute (IWMI)",
    "text": "International Water Management Institute (IWMI)\n\n\n\n\n\n\n\nPorto, Portugal\nAug 2021 – Jan 2022\n6 months\nScientific Modeling and Visualization (contract)\nDesigned complex ETLs and interactive tools to track changes in water budgets and water productivity across multiple river basins. Part of FAO Water Secure Africa initiative (WASA) to inform equitable and sustainable water use policies."
  },
  {
    "objectID": "about.html#worldcover-pbc",
    "href": "about.html#worldcover-pbc",
    "title": "BACOU, Melanie",
    "section": "WorldCover PBC",
    "text": "WorldCover PBC\n\n\n\n\n\n\n\nWashington DC\nTamale, Ghana\nKampala, Tanzania\nAug 2017 – Apr 2021\n3 years 9 months\nHead of Research\nWorldCover engineers solutions to better design, target, and deliver affordable (parametric) weather insurance to small-scale farmers (Ghana, Togo, Kenya, Uganda), and to large-scale fruit and nut tree growers, and to protect entire agricultural value chains against climate risks. Led agrometeorological research across 20 value-chains and agroclimatic zones. Rolled out a real-time pricing engine and multiple APIs on AWS cloud. (technical platform acquired in April 2021)."
  },
  {
    "objectID": "about.html#bill-melinda-gates-foundation-bmgf",
    "href": "about.html#bill-melinda-gates-foundation-bmgf",
    "title": "BACOU, Melanie",
    "section": "Bill & Melinda Gates Foundation (BMGF)",
    "text": "Bill & Melinda Gates Foundation (BMGF)\n\n\n\n\n\n\n\nWashington DC\nSeattle WA\nApr 2017 – Dec 2017\n9 months\nAgricultural Economist (contract)\nBusiness-oriented typologies and characterization of small-holder farming systems in Ghana, Ethiopia, Tanzania, and Nigeria. Under a work assignment with Spatial Development International (now Locana)."
  },
  {
    "objectID": "about.html#abt-associates-inc.",
    "href": "about.html#abt-associates-inc.",
    "title": "BACOU, Melanie",
    "section": "Abt Associates Inc.",
    "text": "Abt Associates Inc.\n\n\n\n\n\n\n\nWashington DC\nJun 2017 – Jul 2017\n2 months\nGeospatial Analyst (contract)\nGeospatial analysis to support USAID AgResults program evaluation in Nigeria, Kenya, and Uganda."
  },
  {
    "objectID": "about.html#international-food-policy-research-institute-ifpri",
    "href": "about.html#international-food-policy-research-institute-ifpri",
    "title": "BACOU, Melanie",
    "section": "International Food Policy Research Institute (IFPRI)",
    "text": "International Food Policy Research Institute (IFPRI)\n\n\n\n\n\n\n\nWashington DC\nSep 2014 – Dec 2016\n2 years 4 months\nSnr. Program Manager\nGenerated subnational socio-economic and biophysical datasets to inform and upscale agricultural research investments in sub-Saharan Africa, track adoption of new agricultural technologies, track CGIAR research investments around the globe, and monitor the impact of policies and investments on small farm-holder livelihoods."
  },
  {
    "objectID": "about.html#ifpri-harvestchoice-program",
    "href": "about.html#ifpri-harvestchoice-program",
    "title": "BACOU, Melanie",
    "section": "IFPRI – HarvestChoice Program",
    "text": "IFPRI – HarvestChoice Program\n\n\n\n\n\n\n\nWashington DC\nMay 2010 – Aug 2014\n4 years 4 months\nAgricultural Economist\nResearch, data and analytics in support of the Global Development Program of the Bill & Melinda Gates Foundation, USAID Feed the Future Africa RISING, the G-8 New Alliance for Food Security and Nutrition, the Alliance for a Green Revolution in Africa (AGRA), and several CGIAR programs focused on agricultural productivity improvement, food security, and poverty reduction in sub-Saharan Africa. In charge of HarvestChoice data releases."
  },
  {
    "objectID": "about.html#ifpri-agrodep-program",
    "href": "about.html#ifpri-agrodep-program",
    "title": "BACOU, Melanie",
    "section": "IFPRI – AGRODEP Program",
    "text": "IFPRI – AGRODEP Program\n\n\n\n\n\n\n\nWashington DC\nDakar, Senegal\nMay 2011 – Oct 2011\n6 months\nInstructor / Web Developer\nThe African Growth and Development Policy Modeling Consortium is a program sponsored by USAID / UKAid. Website migration to a Drupal CMS, incl. preparation of design mockups, content migration, and training of AGRODEP staff. Held a 3-day workshop on household survey data sampling and processing to AGRODEP awardees in Dakar, Senegal."
  },
  {
    "objectID": "about.html#bill-melinda-gates-foundation-bmgf-1",
    "href": "about.html#bill-melinda-gates-foundation-bmgf-1",
    "title": "BACOU, Melanie",
    "section": "Bill & Melinda Gates Foundation (BMGF)",
    "text": "Bill & Melinda Gates Foundation (BMGF)\n\n\n\n\n\n\n\nWashington DC\nSeattle WA\nNov 2012 – Sep 2014\n1 year 11 months\nAgricultural Economist (contract)\nCountry diagnostics, segmentation of farm households, and data visualization for the Foundation’s Agricultural Development Program. Under a work assignment with Spatial Development International (now Locana)."
  },
  {
    "objectID": "about.html#african-development-bank",
    "href": "about.html#african-development-bank",
    "title": "BACOU, Melanie",
    "section": "African Development Bank",
    "text": "African Development Bank\n\n\n\n\n\n\n\nTunis, Tunisia\nOct 2008 – Jan 2009\n4 months\nTeam Lead - Procurement (contract)\nLed a 4-month ICT project for the Bank’s Procurement and Fiduciary Services division aimed at a complete upgrade of its internal SAP® modules (procurement workflow and reporting tools) and external Web portal (procurement tools and information for borrowing governments and the business community). Under a work assignment with Crown Agents UK."
  },
  {
    "objectID": "about.html#development-gateway-foundation",
    "href": "about.html#development-gateway-foundation",
    "title": "BACOU, Melanie",
    "section": "Development Gateway Foundation",
    "text": "Development Gateway Foundation\n\n\n\n\n\n\n\nWashington DC\nMay 2008 – Sep 2008\n5 months\nMonitoring & Evaluation of ICT Programs (contract)\nHelped conduct a 5-month evaluation of the relevance, effectiveness and impact, sustainability, governance and management structure of DGF (5 international programs and staff of 84). The evaluation was forward-looking and provided substantial strategic recommendations to DGF in the areas of ICT4D and aid effectiveness. Data collection included desk review, on-line surveys, usage analysis from DGF servers, phone and in-person stakeholder interviews with over 45 individuals. Under a work assignment with AMEX International."
  },
  {
    "objectID": "about.html#abt-associates-inc.-1",
    "href": "about.html#abt-associates-inc.-1",
    "title": "BACOU, Melanie",
    "section": "Abt Associates Inc.",
    "text": "Abt Associates Inc.\n\n\n\n\n\n\n\nWashington DC\nSana’a, Yemen\nOct 2005 – Sep 2007\n2 years\nSenior Analyst\nManaged environmental cost-benefit and regulatory analyses, and program evaluations for the U.S. EPA Office of Air Quality and Office of Pesticide Programs (multi-year $200K-$500K task orders). Advised and led digital solutions for USAID, MCC, and WTO-funded projects. Supervised analysts, designers, and content experts:\n\nUSAID Global Business, Trade & Investment Services IQC, gbti2.info.\nUSAID Health Systems 20/20, Yemen, mophp-ye.org. Trained the Yemen Ministry of Health on ICT policy and strategy.\nHealth Systems Action Network (HSAN), hsanet.org.\nU.S. EPA Office of Emergency Management, epa.gov/emergencies/. 8-month support to OEM Evaluation and Communication Division on information design."
  },
  {
    "objectID": "about.html#center-for-global-trade-analysis-gtap",
    "href": "about.html#center-for-global-trade-analysis-gtap",
    "title": "BACOU, Melanie",
    "section": "Center for Global Trade Analysis (GTAP)",
    "text": "Center for Global Trade Analysis (GTAP)\n\n\n\n\n\n\n\nWest Lafayette IN\n2001 – 2005\n4 years\nICT and Data Specialist\n\nCoordinated all distance learning activities on Computable General Equilibrium modeling\nAdministered Web and database servers in support of the GTAP Network (over 8,000 researchers in 110 countries)\nCarried out vendor reviews and supervised all aspects of website rollouts\nBuilt web-based tools to streamline conference organization\nScreened funding opportunities for the Center, prepared research proposals and progress reports"
  },
  {
    "objectID": "about.html#landbouw-economisch-instituut-wageningen-ur-lei",
    "href": "about.html#landbouw-economisch-instituut-wageningen-ur-lei",
    "title": "BACOU, Melanie",
    "section": "Landbouw Economisch Instituut – Wageningen UR (LEI)",
    "text": "Landbouw Economisch Instituut – Wageningen UR (LEI)\n\n\n\n\n\n\n\nDen Haag, The Netherlands\nJan 2000 – Aug 2000\n8 months\nInformation Management Specialist (contract)\n\nPlanned and coordinated a first on-line training program on horticultural systems between WUR and agricultural academies in China\nDelivered initial training of trainers to Dutch content experts"
  },
  {
    "objectID": "about.html#purdue-university-dpt-of-agricultural-economics",
    "href": "about.html#purdue-university-dpt-of-agricultural-economics",
    "title": "BACOU, Melanie",
    "section": "Purdue University – Dpt of Agricultural Economics",
    "text": "Purdue University – Dpt of Agricultural Economics\n\n\n\n\n\n\n\nWest Lafayette IN\nHarare, Zimbabwe\nSep 1998 – Dec 1999\n1 year 4 months\nResearch Assistant\n\nWebmaster and technical adviser for a 6-month distance learning project for the Zimbabwean Tariff Commission sponsored by the World Bank\nDeveloped distance learning programs focusing on General Equilibrium theories and applications, sponsored by the United Nations Economic Commission for Africa\nDesigned all educational websites, multimedia content, and CD-ROMs."
  },
  {
    "objectID": "about.html#société-générale-emerging-europe-asset-management-sgeeam",
    "href": "about.html#société-générale-emerging-europe-asset-management-sgeeam",
    "title": "BACOU, Melanie",
    "section": "Société Générale Emerging Europe Asset Management (SGEEAM)",
    "text": "Société Générale Emerging Europe Asset Management (SGEEAM)\n\n\n\n\n\n\n\nLondon, UK\nJan 1996 – May 1996\n5 months\nMarketing and Technical Assistant\n\nAssisted the initial release of high-risk investment funds on Eastern European markets\nPerformed ratio analysis and financial reporting (translation of Polish and Czech accounting standards into IAS)\nBuilt financial databases and automated reports to assist market analysts in monitoring daily fund performance."
  },
  {
    "objectID": "about.html#fimatex-s.a.",
    "href": "about.html#fimatex-s.a.",
    "title": "BACOU, Melanie",
    "section": "FIMATEX S.A.",
    "text": "FIMATEX S.A.\n\n\n\n\n\n\n\nParis, France\nJul 1995 – Oct 1995\n4 months\nMarketing and Sales Assistant\n\nTook part in a strategic diversification from commodity to index derivatives markets\nNegotiated new marketing partnerships with the financial press and software vendors\nCollaborated with traders to produce daily market reports on French MATIF and MONEP bond and index futures and options\nDesigned first business website, see Fimatex (now Boursorama)"
  },
  {
    "objectID": "about.html#seat-france-s.a.",
    "href": "about.html#seat-france-s.a.",
    "title": "BACOU, Melanie",
    "section": "SEAT France S.A.",
    "text": "SEAT France S.A.\n\n\n\n\n\n\n\nCergy Pontoise, France\nJan 1995 – Apr 1995\n4 months\nMarketing and Sales Intern\nContributed to monthly promotional campaigns with advertising agencies and tracked all merchandising programs with SEAT auto dealers across France."
  },
  {
    "objectID": "about.html#purdue-university",
    "href": "about.html#purdue-university",
    "title": "BACOU, Melanie",
    "section": "Purdue University",
    "text": "Purdue University\n\n\n\n\n\n\n\nWest Lafayette IN\n1997 – 2001\nM.Sc. Agricultural Economics\nThesis: Economy-wide Effects of Climate Variability and Climate Prediction in Mozambique, under the supervision of Dr. Channing Arndt, awarded outstanding M.Sc. thesis\nActivities: started and taught Purdue’s Argentine tango student organization"
  },
  {
    "objectID": "about.html#escp-europe",
    "href": "about.html#escp-europe",
    "title": "BACOU, Melanie",
    "section": "ESCP Europe",
    "text": "ESCP Europe\n\n\n\n\n\n\n\nParis, France\nOxford, UK\nBerlin, Germany\n1994 – 1997\nDiplôme de Grande École de Commerce\nDiplom-Kaufmann, MA International Management\nPreviously EAP (European Advanced Program) 3-year/3-country program.\nThesis: Agricultural Derivatives Markets – A Substitute to the Common Agricultural Policy Support Price Mechanisms"
  },
  {
    "objectID": "about.html#lycée-louis-le-grand",
    "href": "about.html#lycée-louis-le-grand",
    "title": "BACOU, Melanie",
    "section": "Lycée Louis-le-Grand",
    "text": "Lycée Louis-le-Grand\n\n\n\n\n\n\n\nParis, France\n1992 – 1994\nClasse Prépa HEC (2-year B.Sc. equivalent) business mathematics and statistics, contemporary history, philosophy."
  },
  {
    "objectID": "about.html#section",
    "href": "about.html#section",
    "title": "Melanie Bacou",
    "section": "",
    "text": "t.me/mbacou\n linkedin.com/in/mbacou\n github.com/mbacou\n orcid.org/0000-0003-1810-6818"
  },
  {
    "objectID": "posts/2020-12-02-era5-ca/index.html",
    "href": "posts/2020-12-02-era5-ca/index.html",
    "title": "ERA5-LAND Temperature Validation (California)",
    "section": "",
    "text": "Can we justify Y2017 correction to ERA5 grids over OLAM portfolio?\nPortfolio-wide ERA5-LAND temperature validation against NOAA GHCN ground records\n\n\n\nlibrary(knitr)\n## Error in fun(pkgname, pkgpath) : could not find function \"fun\"\n## Error in fun(pkgname, pkgpath) : could not find function \"fun\"\n## Error in fun(pkgname, pkgpath) : could not find function \"fun\"\n## Error in fun(pkgname, pkgpath) : could not find function \"fun\"\n## Error in fun(pkgname, pkgpath) : could not find function \"fun\"\n## Error in fun(pkgname, pkgpath) : could not find function \"fun\"\n## Error in fun(pkgname, pkgpath) : could not find function \"fun\"\n## Error in fun(pkgname, pkgpath) : could not find function \"fun\"\n## Error in fun(pkgname, pkgpath) : could not find function \"fun\"\n## Error in fun(pkgname, pkgpath) : could not find function \"fun\"\n## Error in fun(pkgname, pkgpath) : could not find function \"fun\"\nlibrary(lubridate)\n## \n## Attaching package: 'lubridate'\n## The following objects are masked from 'package:base':\n## \n##     date, intersect, setdiff, union\nlibrary(ggplot2)\nlibrary(raster)\n## Loading required package: sp\nlibrary(scales)\nlibrary(data.table)\n## \n## Attaching package: 'data.table'\n## The following object is masked from 'package:raster':\n## \n##     shift\n## The following objects are masked from 'package:lubridate':\n## \n##     hour, isoweek, mday, minute, month, quarter, second, wday, week, yday,\n##     year\nlibrary(zoo)\n## \n## Attaching package: 'zoo'\n## The following objects are masked from 'package:base':\n## \n##     as.Date, as.Date.numeric\nlibrary(rgdal)\n## Please note that rgdal will be retired by the end of 2023,\n## plan transition to sf/stars/terra functions using GDAL and PROJ\n## at your earliest convenience.\n## \n## rgdal: version: 1.5-29, (SVN revision 1165M)\n## Geospatial Data Abstraction Library extensions to R successfully loaded\n## Loaded GDAL runtime: GDAL 3.4.3, released 2022/04/22\n## Path to GDAL shared files: /usr/share/gdal\n## GDAL binary built with GEOS: TRUE \n## Loaded PROJ runtime: Rel. 8.2.0, November 1st, 2021, [PJ_VERSION: 820]\n## Path to PROJ shared files: /home/mbacou/.local/share/proj:/usr/share/proj\n## PROJ CDN enabled: FALSE\n## Linking to sp version:1.4-6\n## To mute warnings of possible GDAL/OSR exportToProj4() degradation,\n## use options(\"rgdal_show_exportToProj4_warnings\"=\"none\") before loading sp or rgdal.\nlibrary(rgeos)\n## Warning in fun(libname, pkgname): rgeos: versions of GEOS runtime 3.10.2-CAPI-1.16.0\n## and GEOS at installation 3.10.1-CAPI-1.16.0differ\n## rgeos version: 0.5-9, (SVN revision 684)\n##  GEOS runtime version: 3.10.2-CAPI-1.16.0 \n##  Please note that rgeos will be retired by the end of 2023,\n## plan transition to sf functions using GEOS at your earliest convenience.\n##  GEOS using OverlayNG\n##  Linking to sp version: 1.4-6 \n##  Polygon checking: TRUE\nlibrary(rnoaa)\n\ndir &lt;- \".\"\nload(file.path(dir, \"./tmp/2020-burn_olam_usa_07.RData\"))\n\n\n# Clear workspace, keep portfolio details\nload(file.path(dir, \"./tmp/2020-burn_olam_usa_06.RData\"))\nrm(list=setdiff(ls(), c(\"dir\", \"pts.dt\", \"dt.era\", \"dt.imp\")))\n\npts &lt;- SpatialPointsDataFrame(pts.dt[, .(X,Y)], data.frame(pts.dt), \n  proj4string=CRS(\"+init=epsg:4326\"))\n\n\n# Get GHCN ground obs across ZOI\nstations &lt;- ghcnd_stations()\nsetDT(stations)\nvars &lt;- c(\"PRCP\", \"TAVG\", \"TMAX\", \"TMIN\")\nstations[element %in% vars, .N, by=element]\nstations &lt;- stations[state==\"CA\" & element %in% vars]\n\n# Convert to spatial\nstations.sp &lt;- SpatialPointsDataFrame(stations[, .(longitude, latitude)], stations,\n  proj4string=CRS(\"+init=epsg:4326\"))\n\n# Keep only stations within 30 km of any OLAM site\npts &lt;- spTransform(pts, CRS(\"+init=epsg:3310\"))\nstations.sp &lt;- spTransform(stations.sp, CRS(\"+init=epsg:3310\"))\ndist &lt;- rgeos::gWithinDistance(stations.sp, pts, dist=30*1000, byid=TRUE)\ndist &lt;- colSums(dist)\nnames(dist) &lt;- stations.sp$id\ndist &lt;- dist[dist&gt;0]\nids &lt;- names(dist)\n\npts &lt;- spTransform(pts, CRS(\"+init=epsg:4326\"))\nstations.sp &lt;- spTransform(stations.sp, CRS(\"+init=epsg:4326\"))\n\nplot(extent(pts), lty=2, col=NA, xlab=NA, ylab=NA)\nplot(stations.sp[stations.sp$id %in% ids,], col=\"black\", add=T)\nplot(pts, col=\"blue\", pch=\"*\", add=T)\n\nids &lt;- stations[id %in% ids & element %in% vars & last_year &gt; 2009, unique(id)]\nstations[id %in% ids & element %in% vars]\n\n# Get daily station time-series for the 29 selected\n# Request seems to time out when too large so batch it\nstations.dt &lt;- lapply(ids, function(x) \n  try(ghcnd_search(x, var=vars, date_min=\"2010-01-01\", refresh=T)))\nstations.dt &lt;- stations.dt[sapply(stations.dt, function(x) class(x)!=\"try-error\")]\nstations.dt &lt;- do.call(c, stations.dt)\nstations.dt &lt;- lapply(stations.dt, function(x) setnames(x, 2, \"value\"))\nstations.dt &lt;- rbindlist(stations.dt, idcol=\"var\")\n\nstations.dt[, .N, by=var]\npar(mfrow=c(2,2))\nfor(i in stations.dt[, unique(var)]) stations.dt[var==i, hist(value, main=i)]\npar(mfrow=c(1,1))\n\n# Convert tenths of degrees Celsius to °C\nstations.dt[, value := as.numeric(value)\n][var %in% tolower(vars[2:4]), value := value/10]\n\nids &lt;- stations.dt[, unique(id)]\n\n\n# Extract ERA5 at stations' coordinates\nx &lt;- c(\"2010-01-01\", \"2020-07-31\")\ncat &lt;- wc_catalog(x, code=\"era5_temp_h_usa_ca\")\ndt &lt;- wc_extract(\n  stations[id %in% ids, .N, by=.(loc_id=id, X=longitude, Y=latitude)][, N:=NULL], \n  catalog=cat)\n\n# Verify sequence\ndt[c(1, .N), .(date, time)]\ndt[, .N, by=.(y=year(date), loc_id)][N!=8760 & N!=8784 & N!=5112]\n# =&gt; OK\n\ndt[,\n  # Apply timezone\n  time := with_tz(as.POSIXct(paste(date, time, sep=\" \")), tzone=\"America/Los_Angeles\")\n][, `:=`(\n  # Convert to IDate\n  date = as.IDate(time),\n  time = as.ITime(time)\n)]\n\n# Verify\ndt[c(1, .N), .(date, time)]\ndt[, .N, by=loc_id][, uniqueN(N)]\ndt[, hist(value)]\ndt[, summary(value)]\n#   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n# -6.623  10.852  17.053  17.939  24.544  43.893  \n\n# Daily\ndt &lt;- dt[, .(\n  Tmean = mean(value, na.rm=T),\n  Tmin = min(value, na.rm=T),\n  Tmax = max(value, na.rm=T)\n), keyby=.(loc_id, date)]\n\n# Combine with GHCN\ntmp &lt;- dcast(stations.dt, id+date~var, value.var=\"value\")\ndt[tmp, on=.(loc_id=id, date=date), `:=`(\n  GHCN_Tmean = i.tavg,\n  GHCN_Tmin = i.tmin,\n  GHCN_Tmax = i.tmax\n)]\n\n\nrm(x, i, j, t, tmp)\nsave.image(file.path(dir, \"./tmp/2020-burn_olam_usa_07.RData\"))\n\n\nResults\n10-year comparisons between ERA5-LAND and GHCN station network over Feb-March risk period. 11 stations (under 30-km from production sites and with daily temperature records after 2010) are selected for the comparison.\n\nplot(cat[date==\"2020-02-01\", crop(raster(file, 1), stations.sp[stations.sp$id %in% ids,])], \n  xlab=NA, ylab=NA, main=\"Tmean °C\", sub=\"ERA5 2020-02-01 00:00\")\n## Loading required namespace: ncdf4\nplot(crop(stations.sp[!stations.sp$id %in% ids,], pts), col=\"black\", add=T)\nplot(stations.sp[stations.sp$id %in% ids,], col=\"red\", add=T)\nplot(pts, col=\"blue\", pch=\"*\", add=T)\nplot(pts[pts$loc_id==25,], col=\"blue\", pch=1, cex=2, add=T)\nlegend(\"bottomleft\", \n  legend=c(\"GHCN station\", \"GHCN station ≤ 30-km\", \"OLAM production site\", \"Main site\"),\n  col=c(\"black\", \"red\", \"blue\", \"blue\"), pch=c(\"+\", \"+\", \"*\", \"o\"), cex=.7)\n## Warning in (function (s, units = \"user\", cex = NULL, font = NULL, vfont = NULL, :\n## conversion failure on 'GHCN station ≤ 30-km' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in (function (s, units = \"user\", cex = NULL, font = NULL, vfont = NULL, :\n## conversion failure on 'GHCN station ≤ 30-km' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in (function (s, units = \"user\", cex = NULL, font = NULL, vfont = NULL, :\n## conversion failure on 'GHCN station ≤ 30-km' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in text.default(x, y, ...): conversion failure on 'GHCN station ≤ 30-km' in\n## 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in text.default(x, y, ...): conversion failure on 'GHCN station ≤ 30-km' in\n## 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in text.default(x, y, ...): conversion failure on 'GHCN station ≤ 30-km' in\n## 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n\n\n\n\n\n\n\n\nList of GHCN stations retained in the analysis.\n\n\nkable(stations[id %in% ids & element %in% c(\"TMIN\", \"TAVG\"), .(\n  first_year, last_year\n), keyby=.(id, name, element)]\n)\n\n\n\n\n\n\n\n\n\n\n\nid\nname\nelement\nfirst_year\nlast_year\n\n\n\n\nUSC00040444\nBAKERSFIELD 5 NW\nTMIN\n1999\n2020\n\n\nUSC00045233\nMADERA\nTMIN\n1928\n2020\n\n\nUSC00045532\nMERCED\nTMIN\n1899\n2020\n\n\nUSC00048122\nSHAFTER 6E\nTMIN\n2009\n2020\n\n\nUSC00048752\nTAFT\nTMIN\n1994\n2011\n\n\nUSR0000CCAT\nCATHEYS VALLEY CALIFORNIA\nTAVG\n1999\n2020\n\n\nUSR0000CCAT\nCATHEYS VALLEY CALIFORNIA\nTMIN\n1999\n2020\n\n\nUSR0000CGSP\nGREEN SPRING CALIFORNIA\nTAVG\n1990\n2020\n\n\nUSR0000CGSP\nGREEN SPRING CALIFORNIA\nTMIN\n1990\n2020\n\n\nUSW00023155\nBAKERSFIELD AP\nTAVG\n1998\n2020\n\n\nUSW00023155\nBAKERSFIELD AP\nTMIN\n1937\n2020\n\n\nUSW00023257\nMERCED MUNI AP\nTAVG\n1998\n2005\n\n\nUSW00023257\nMERCED MUNI AP\nTMIN\n1998\n2020\n\n\nUSW00023258\nMODESTO CITY CO AP\nTAVG\n1998\n2005\n\n\nUSW00023258\nMODESTO CITY CO AP\nTMIN\n1927\n2020\n\n\nUSW00093242\nMADERA MUNI AP\nTAVG\n1998\n2005\n\n\nUSW00093242\nMADERA MUNI AP\nTMIN\n1998\n2020\n\n\n\n\n\n10-year summary.\n\n\npar(mfrow=c(2,2))\nfor(i in stations.dt[, unique(var)]) stations.dt[var==i, hist(value, main=i)]\n\n\n\n\n\n\n\n\n\n\nTemperature Minima\n2010-2014\n\nprd &lt;- c(\"2020-02-01\", \"2020-03-31\")\ndt[, sdate := as.Date(date)][, year := year(date)]\nyear(dt$sdate) &lt;- 2020\n\ntmp &lt;- dt[yday(date) %between% yday(prd), .(\n  Tmin = mean(Tmin, na.rm=T),\n  GHCN_Tmin = mean(GHCN_Tmin, na.rm=T),\n  diff_Tmean = mean(Tmean - GHCN_Tmean, na.rm=T),\n  diff_Tmin = mean(Tmin - GHCN_Tmin, na.rm=T)\n), by=.(year, date, sdate)\n][, sign := diff_Tmin &gt; 0]\n\nggplot(tmp[year(date) %between% c(2010, 2014)], aes(x=sdate)) +\n  geom_line(aes(y=Tmin, color=\"ERA5 Tmin\")) + \n  geom_point(aes(y=Tmin, color=\"ERA5 Tmin\"), size=.5) +\n  geom_line(aes(y=GHCN_Tmin, color=\"GHCN Tmin\")) + \n  geom_point(aes(y=GHCN_Tmin, color=\"GHCN Tmin\"), size=.5) +\n  scale_x_date(date_labels=\"%b-%d\", breaks=\"2 days\") +\n  scale_color_discrete(NULL) +\n  facet_wrap(\"year\", ncol=1) +\n  xlab(NULL) +\n  ggtitle(\"Temperature Mean of Min -- ERA5 vs. GHCN (19 WS)\") +\n  theme(\n    legend.position=\"top\", legend.justification=0, \n    axis.text.x=element_text(angle=-90)\n  )\n\n\n\n\n\n\n\n\n2015-2020\n\nggplot(tmp[year(date) &gt; 2014], aes(x=sdate)) +\n  geom_line(aes(y=Tmin, color=\"ERA5 Tmin\")) + \n  geom_point(aes(y=Tmin, color=\"ERA5 Tmin\"), size=.5) +\n  geom_line(aes(y=GHCN_Tmin, color=\"GHCN Tmin\")) + \n  geom_point(aes(y=GHCN_Tmin, color=\"GHCN Tmin\"), size=.5) +\n  scale_x_date(date_labels=\"%b-%d\", breaks=\"2 days\") +\n  scale_color_discrete(NULL) +\n  facet_wrap(\"year\", ncol=1) +\n  xlab(NULL) +\n  ggtitle(\"Temperature Mean of Min -- ERA5 vs. GHCN (19 WS)\") +\n  theme(\n    legend.position=\"top\", legend.justification=0, \n    axis.text.x=element_text(angle=-90)\n  )\n\n\n\n\n\n\n\n\n2010-2014\n\nggplot(tmp[year(date) %between% c(2010, 2014)], \n  aes(sdate, color=sign)) +\n  geom_segment(aes(xend=sdate, y=Tmin, yend=GHCN_Tmin), size=.8, lineend=\"butt\") +\n  geom_point(aes(y=GHCN_Tmin)) +\n  scale_x_date(date_labels=\"%b-%d\", breaks=\"3 day\") +\n  scale_color_discrete(NULL, labels=c(\"ERA5 ≤ GHCN\", \"ERA5 &gt; GHCN\")) +\n  facet_wrap(\"year\", ncol=1) +\n  xlab(NULL) +\n  ggtitle(\"Temperature Mean of Min -- ERA5 vs. GHCN WS\") +\n  theme(\n    legend.position=\"top\", legend.justification=0, \n    axis.text.x=element_text(angle=-90)\n  )\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :\n## conversion failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :\n## conversion failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :\n## conversion failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n\n\n\n\n\n\n\n\n2015-2020\n\nggplot(tmp[year(date) &gt; 2014], \n  aes(sdate, color=sign)) +\n  geom_segment(aes(xend=sdate, y=Tmin, yend=GHCN_Tmin), size=.8, lineend=\"butt\") +\n  geom_point(aes(y=GHCN_Tmin)) +\n  scale_x_date(date_labels=\"%b-%d\", breaks=\"3 day\") +\n  scale_color_discrete(NULL, labels=c(\"ERA5 ≤ GHCN\", \"ERA5 &gt; GHCN\")) +\n  facet_wrap(\"year\", ncol=1) +\n  xlab(NULL) +\n  ggtitle(\"Temperature Mean of Min -- ERA5 vs. GHCN WS\") +\n  theme(\n    legend.position=\"top\", legend.justification=0, \n    axis.text.x=element_text(angle=-90)\n  )\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : conversion\n## failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :\n## conversion failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;e2&gt;\n## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :\n## conversion failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;89&gt;\n## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :\n## conversion failure on 'ERA5 ≤ GHCN' in 'mbcsToSbcs': dot substituted for &lt;a4&gt;\n\n\n\n\n\n\n\n\nDifferences between ERA5 Tmin and GHCN Tmin over risk period:\n\ndt[yday(date) %in% yday(prd), summary(Tmin - GHCN_Tmin)]\n##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n## -5.9080 -1.1880  0.2500  0.2953  1.5979  9.7133     206\n\nDifferences between ERA5 Tmin and GHCN Tmin over risk period (GHCN below 0°C):\n\ndt[yday(date) %in% yday(prd) & GHCN_Tmin &lt;= 0, summary(Tmin - GHCN_Tmin)]\n##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n##   1.364   1.822   2.350   2.058   2.350   2.405\n\nDifferences between ERA5 Tmean and GHCN Tmean over risk period:\n\ndt[yday(date) %in% yday(prd), summary(Tmean - GHCN_Tmean)]\n##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n## -4.5485 -1.7915 -1.1321 -0.9827 -0.1575  1.9854     359\n\nDifferences between ERA5 Tmax and GHCN Tmax over risk period:\n\ndt[yday(date) %in% yday(prd), summary(Tmax - GHCN_Tmax)]\n##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n## -4.6174 -1.4994 -0.6568 -0.6119  0.1649  4.7969     204\n\nCorrelation summary on temperature minima (all available dates):\n\ntmp &lt;- dt[!is.na(GHCN_Tmin), .(cor = cor(GHCN_Tmin, Tmin, method=\"pearson\"))]\nsummary(tmp$cor)\n##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n##  0.9258  0.9258  0.9258  0.9258  0.9258  0.9258\n\nCorrelation summary on temperature minima (GHCN below 0°C, all available dates):\n\ntmp &lt;- dt[!is.na(GHCN_Tmin) & GHCN_Tmin &lt;= 0, .(cor = cor(GHCN_Tmin, Tmin, method=\"pearson\"))]\nsummary(tmp$cor)\n##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n##  0.2952  0.2952  0.2952  0.2952  0.2952  0.2952\n\nERA5 bias along GHCN ground temperatures:\n\n\ntmp &lt;- dt[!is.na(GHCN_Tmin), .(\n  GHCN_Tmean, GHCN_Tmin, \n  Tmean_bias = GHCN_Tmean - Tmean,\n  Tmin_bias = GHCN_Tmin - Tmin\n)]\n\nggplot(tmp) +\n  geom_smooth(aes(x=GHCN_Tmean, y=Tmean_bias, color=\"Bias (Tmean)\")) +\n  geom_smooth(aes(x=GHCN_Tmin, y=Tmin_bias, color=\"Bias (Tmin)\")) +\n  geom_hline(aes(yintercept=0), color=\"black\", linetype=1) +\n  geom_vline(aes(xintercept=0), color=\"black\", linetype=3) +\n  scale_color_discrete(NULL) +\n  scale_x_continuous(n.breaks=10) +\n  scale_y_continuous(n.breaks=10) +\n  xlab(\"GHCN Temp. (°C)\") + ylab(\"ERA5 Bias (°C)\") +\n  ggtitle(\"ERA5 Bias vs. GHCN WS (2010-2020)\") +\n  theme(\n    legend.position=\"top\", legend.justification=0\n  )\n## `geom_smooth()` using method = 'gam' and formula 'y ~ s(x, bs = \"cs\")'\n## Warning: Removed 27289 rows containing non-finite values (stat_smooth).\n## `geom_smooth()` using method = 'gam' and formula 'y ~ s(x, bs = \"cs\")'\n\n\n\n\n\n\n\n\n\n\nFrost Index\n\n\ndegree_frost &lt;- c(-4, 0)\n\n# Add daily index values\nsetorder(dt, loc_id, date)\nidx &lt;- dt[yday(date) %between% yday(prd), .(\n  idx = sum(degree_frost[2] - pmin(\n    fifelse(Tmin &lt; degree_frost[1], degree_frost[1], Tmin), degree_frost[2]), na.rm=T),\n  idx_ghcn = sum(degree_frost[2] - pmin(\n    fifelse(GHCN_Tmin &lt; degree_frost[1], degree_frost[1], GHCN_Tmin), degree_frost[2]), na.rm=T)\n), by=.(loc_id, year)]\n\n\n\ntmp &lt;- melt(idx, id.vars=c(\"loc_id\", \"year\"))\ntmp &lt;- tmp[, .(value=mean(value, na.rm=T)), by=.(year, variable)]\n\nggplot(tmp[variable %in% c(\"idx\", \"idx_ghcn\")], \n  aes(year, value, fill=variable)) +\n  geom_col(position=\"dodge\", color=NA, alpha=.8, width=.8) +\n  scale_fill_discrete(NULL, labels=c(\"GHCN FDD\", \"ERA5 FDD\")) +\n  scale_x_continuous(breaks=2010:2020) +\n  xlab(NULL) + ylab(NULL) +\n  ggtitle(\"Mean FDD across Stations -- ERA5 vs. GHCN (2010-2020)\") +\n  theme(\n    axis.text.x=element_text(angle=-90),\n    legend.position=\"top\", legend.justification=0\n  )\n\n\n\n\n\n\n\n\n\n\nggplot(idx[idx_ghcn&gt;0], aes(idx_ghcn, idx)) +\n  geom_abline(linetype=3) +\n  geom_smooth(aes(color=\"ERA5 non-adjusted\")) +\n  geom_point(shape=\"+\", size=4) +\n  scale_color_discrete(NULL) +\n  xlab(\"GHCN FDD\") + ylab(\"ERA5 FDD\") +\n  ggtitle(\"FDD -- ERA5 vs. GHCN (2010-2020)\") +\n  theme(\n    legend.position=\"top\", legend.justification=0\n  )\n## `geom_smooth()` using method = 'loess' and formula 'y ~ x'\n\n\n\n\n\n\n\n\n\n\n\n\nCitationBibTeX citation:@online{bacou2020,\n  author = {BACOU, Melanie},\n  title = {ERA5-LAND {Temperature} {Validation} {(California)}},\n  date = {2020-12-02},\n  url = {https://mbacou.github.io/mb-labs/posts/2020-12-02-era5-ca},\n  langid = {en}\n}\nFor attribution, please cite this work as:\nBACOU, Melanie. 2020. “ERA5-LAND Temperature Validation\n(California).” December 2, 2020. https://mbacou.github.io/mb-labs/posts/2020-12-02-era5-ca."
  },
  {
    "objectID": "posts/2022-12-01-armyvet/index.html#expand-to-learn-about-collapse",
    "href": "posts/2022-12-01-armyvet/index.html#expand-to-learn-about-collapse",
    "title": "Theme Configuration",
    "section": "Expand To Learn About Collapse",
    "text": "Expand To Learn About Collapse\nThis is an example of a ‘folded’ caution callout that can be expanded by the user. You can use collapse=\"true\" to collapse it by default or collapse=\"false\" to make a collapsible callout that is expanded by default."
  },
  {
    "objectID": "posts/2022-12-01-theme/index.html",
    "href": "posts/2022-12-01-theme/index.html",
    "title": "Theme Configuration",
    "section": "",
    "text": "Sometimes I may want an optional flushed banner with random static or dynamic content. Note that this will push and collapse the TOC to the top of the page until the user scrolls past the &lt;div&gt;. For example here is how to insert a dynamic map inside a flushed &lt;div class=\"column-screen\"&gt; element, like the one just above:"
  },
  {
    "objectID": "posts/2022-12-01-theme/index.html#expand-to-learn-about-collapse",
    "href": "posts/2022-12-01-theme/index.html#expand-to-learn-about-collapse",
    "title": "Theme Configuration",
    "section": "Expand To Learn About Collapse",
    "text": "Expand To Learn About Collapse\nThis is an example of a ‘folded’ caution callout that can be expanded by the user. You can use collapse=\"true\" to collapse it by default or collapse=\"false\" to make a collapsible callout that is expanded by default."
  },
  {
    "objectID": "posts/2022-12-01-theme/index.html#heading-2",
    "href": "posts/2022-12-01-theme/index.html#heading-2",
    "title": "Theme Configuration",
    "section": "Heading 2",
    "text": "Heading 2\nSample paragraph content.\n\nHeading 3\nSample paragraph content with list of items:\n\nList 1\nList 2\nList 3\n\nOrdered list:\n\nList 1\n\nList 2\n\nList 3\n\n\nHeading 4\nSample paragraph content.\n\nBlockquote title\nBlockquote content comes here…\n– And small description\n\n\nHeading 5\nSample paragraph content.\nHere is a footnote reference,2 and another.3\n2 Here is the footnote.3 Here’s one with multiple blocks.Subsequent paragraphs are indented to show that they belong to the previous footnote."
  },
  {
    "objectID": "posts/2022-12-01-theme/index.html#color-system",
    "href": "posts/2022-12-01-theme/index.html#color-system",
    "title": "Theme Configuration",
    "section": "Color System",
    "text": "Color System\nStandard Bootstrap 12-color palette that strives to complement my Kubuntu desktop1. Some colors are redefined to better suit the callout color logic below.\n1 KDE, 30 years later, still going strong! library(htmltools)\n\nx &lt;- c(\"info\", \"success\", \"warning\", \"danger\", \"primary\", \"secondary\",\n  \"dark\", \"light\", \"white\", \"indigo\", \"purple\", \"pink\")\ny &lt;-  c(\"blue\", \"green\", \"orange\", \"red\", \"teal\", \"cyan\",\n  \"#222e32\", \"#fefefe\", \"#ffffff\", \"#9b59b6\", \"#98796f\", \"#aea39a\")\nz &lt;- c(rep(2,6), rep(4,6))\n\nl &lt;- lapply(1:length(x),\n  function(i) div(class=paste0(\"g-col-\", z[i], \" small p-2 bg-\", x[i]), \n    HTML(x[i], \"&lt;br/&gt;(\", y[i], \")\")))\n\ndiv(class=\"grid\", style=\"--bs-gap: .5rem;\", tagList(l))\n\ninfo ( blue )\nsuccess ( green )\nwarning ( orange )\ndanger ( red )\nprimary ( teal )\nsecondary ( cyan )\ndark ( #222e32 )\nlight ( #fefefe )\nwhite ( #ffffff )\nindigo ( #9b59b6 )\npurple ( #98796f )\npink ( #aea39a )"
  },
  {
    "objectID": "posts/2022-12-01-theme/index.html#callout-blocks",
    "href": "posts/2022-12-01-theme/index.html#callout-blocks",
    "title": "Theme Configuration",
    "section": "Callout Blocks",
    "text": "Callout Blocks\n\n\n\n\n\n\nNote\n\n\n\nNote that there are five types of callouts, including: note, warning, important, tip, and caution.\n\n\n\n\n\n\n\n\nTip with Title\n\n\n\nThis is an example of a callout with a title.\n\n\n\n\n\n\n\n\nCautious\n\n\n\n\n\nExpand To Learn About Collapse\nThis is an example of a ‘folded’ caution callout that can be expanded by the user. You can use collapse=\"true\" to collapse it by default or collapse=\"false\" to make a collapsible callout that is expanded by default.\n\n\n\n\n\n\n\n\n\nImportant\n\n\n\nThis is a callout with a title.\n\n\n\n\n\n\n\n\nWarning\n\n\n\nThis is a callout with a title."
  },
  {
    "objectID": "posts/2022-12-01-theme/index.html#typography",
    "href": "posts/2022-12-01-theme/index.html#typography",
    "title": "Theme Configuration",
    "section": "Typography",
    "text": "Typography\nBootstrap default line-height and sizing typically work. No change here aside from using Roboto and Roboto Condensed fonts.\n\nHeading 3\nSample paragraph content with list of items:\n\nList 1\nList 2\nList 3\n\nOrdered list:\n\nList 1\n\nList 2\n\nList 3\n\n\nHeading 4\nSample paragraph content.\n\nBlockquote title\nBlockquote content comes here…\n– And small description\n\n\nHeading 5\nSample paragraph content.\nHere is a footnote reference,2 and another.3\n2 Here is the footnote.3 Here’s one with multiple blocks.\nSubsequent paragraphs are indented to show that they belong to the previous footnote."
  },
  {
    "objectID": "posts/2022-12-01-theme/index.html#tables",
    "href": "posts/2022-12-01-theme/index.html#tables",
    "title": "Theme Configuration",
    "section": "Tables",
    "text": "Tables\nI normally like my tables slightly more condensed than Bootstrap’s defaults and to resemble LaTeX typesetting, so here we go.\nSimple tables.\n\nDefault\n\n\nfruit\nprice\n\n\n\n\napple\n2.05\n\n\npear\n1.37\n\n\norange\n3.09\n\n\n\n\nborderless hover sm\n\n\nfruit\nprice\n\n\n\n\napple\n2.05\n\n\npear\n1.37\n\n\norange\n3.09\n\n\n\n\nstriped hover sm\n\n\nfruit\nprice\n\n\n\n\napple\n2.05\n\n\npear\n1.37\n\n\norange\n3.09\n\n\n\n\nstriped hover sm secondary\n\n\nfruit\nprice\n\n\n\n\napple\n2.05\n\n\npear\n1.37\n\n\norange\n3.09\n\n\n\n\nknitr::kable(\n  mtcars[1:6, 1:10]\n)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nmpg\ncyl\ndisp\nhp\ndrat\nwt\nqsec\nvs\nam\ngear\n\n\n\n\nMazda RX4\n21.0\n6\n160\n110\n3.90\n2.620\n16.46\n0\n1\n4\n\n\nMazda RX4 Wag\n21.0\n6\n160\n110\n3.90\n2.875\n17.02\n0\n1\n4\n\n\nDatsun 710\n22.8\n4\n108\n93\n3.85\n2.320\n18.61\n1\n1\n4\n\n\nHornet 4 Drive\n21.4\n6\n258\n110\n3.08\n3.215\n19.44\n1\n0\n3\n\n\nHornet Sportabout\n18.7\n8\n360\n175\n3.15\n3.440\n17.02\n0\n0\n3\n\n\nValiant\n18.1\n6\n225\n105\n2.76\n3.460\n20.22\n1\n0\n3\n\n\n\nA full-width table to increase content space"
  },
  {
    "objectID": "posts/2022-12-01-theme/index.html#code-blocks-and-plots",
    "href": "posts/2022-12-01-theme/index.html#code-blocks-and-plots",
    "title": "Theme Configuration",
    "section": "Code Blocks and Plots",
    "text": "Code Blocks and Plots\nI use thematic package to generate lattice and ggplot palettes that complement Bootstrap colors.\n\nlibrary(thematic)\n\n# Theme with my default sequential and qualitative palettes\nthematic_on &lt;- function(bg=\"transparent\", fg=\"#111719\", accent=\"#789494\",\n  font=thematic::font_spec(\"Roboto Condensed\"),\n  sequential=thematic::sequential_gradient(\n    fg_weight=.5, bg_weight=.5, fg_low=FALSE),\n  qualitative=c(\n    \"#789494\", \"#445e64\", \"#222e32\", \n    \"#aea39a\", \"#98796f\", \"#9b59b6\", \"#3daee9\",\n    \"#27ae60\", \"#edcd37\", \"#f67400\", \"#da4453\"),\n  ...) thematic::thematic_on(\n    bg, fg, accent, font, sequential, qualitative, ...)\n\nNext I apply a few extra –opinionated– changes to ggthemes::theme_wsj(), mostly no background fills and custom fonts. The final theme function is defined as theme_mblabs().\n\nlibrary(ggplot2)\nthematic_on()\n\ntheme_mblabs &lt;- function(\n  title = NA,\n  subtitle = NA,\n  base_size = 12,\n  base_family = \"Roboto Condensed\",\n  base_bg = \"transparent\",\n  base_color = \"#111719\",\n  accent_color = \"#11171999\", ...) ggthemes::theme_wsj(\n    base_size = base_size,\n    base_family = base_family,\n    title_family = base_family\n  ) + theme(\n    \n    text = element_text(color=base_color, lineheight=.8),\n    line = element_line(color=base_color),\n    panel.background = element_rect(fill=base_bg, color=NA),\n    plot.background = element_rect(fill=base_bg, color=NA),\n    legend.box.background = element_rect(fill=base_bg, color=NA),\n    legend.background = element_rect(fill=base_bg, color=NA),\n    \n    plot.title = element_text(\n      family=base_family, face=\"plain\", hjust=0, size=base_size*1.25),\n    plot.subtitle = element_text(\n      family=base_family, face=\"plain\", hjust=0, size=base_size, \n      color=accent_color[1]),\n    strip.text = element_text(\n      family=base_family, face=\"bold\", hjust=0, size=base_size),\n    plot.caption = element_text(size=base_size*.9, hjust=0),\n    \n    axis.text = element_text(size=base_size),\n    axis.title.x = element_text(size=base_size, face=\"bold\", hjust=1),\n    axis.title.y = element_blank(),\n    \n    legend.title = element_text(size=base_size*0.9, hjust=0),\n    legend.margin = margin(0,0,0,1, \"lines\"),\n    legend.key.size = unit(1, \"lines\"),\n    legend.text = element_text(base_size*0.8),\n    legend.position=\"right\", legend.justification=\"left\",\n    legend.direction=\"vertical\",\n    ...)\n\n# Save my defaults for reuse\nsave(theme_mblabs, thematic_on, file=\"theme_mblabs.rda\")\n\n# Apply updated ggplot theme\ntheme_set(theme_mblabs())\n\nSimply visualize new lattice and ggplot color palettes.\n\nggplot(mtcars, aes(factor(carb), mpg, fill=factor(carb))) + geom_col()\n\n\n\n\n\n\n\n\n\nggplot(mtcars, aes(wt, mpg, color=gear, linewidth=carb)) + \n  geom_point() + geom_smooth() + \n  labs(title=\"My Title\", subtitle=\"My Subtitle\", caption=\"My plot caption\")\n\n\n\n\n\n\n\n\n\nggplot(faithfuld, aes(waiting, eruptions, z = density)) +\n  geom_raster(aes(fill = density)) +\n  geom_contour()\n\n\n\n\n\n\n\n\n\nggplot(mtcars, aes(wt, mpg, color = factor(cyl))) + geom_point()\n\n\n\n\n\n\n\n\n\nlattice::show.settings()"
  },
  {
    "objectID": "portfolio/webapps.html",
    "href": "portfolio/webapps.html",
    "title": "Interactive Web Applications",
    "section": "",
    "text": "Complex statistical analyses and economic models always require robust end-user design."
  },
  {
    "objectID": "portfolio/webapps.html#water-accounting-balances",
    "href": "portfolio/webapps.html#water-accounting-balances",
    "title": "Interactive Web Applications",
    "section": "Water accounting Balances",
    "text": "Water accounting Balances\nModel visualization for large-scale water accounting models"
  },
  {
    "objectID": "portfolio/webapps.html#simulating-historical-claim-costs",
    "href": "portfolio/webapps.html#simulating-historical-claim-costs",
    "title": "Interactive Web Applications",
    "section": "Simulating Historical Claim Costs",
    "text": "Simulating Historical Claim Costs\nVisual interface for agricultural insurance\nReal-time pricing of weather-index insurance\nThis tool supports WorldCover PBC agricultural insurance operations.\nHow to cite Confidential.\nTools R/Shiny, bs4Dash, bslib, shinyWidgets, data.table, leaflet, highcharter, terra"
  }
]